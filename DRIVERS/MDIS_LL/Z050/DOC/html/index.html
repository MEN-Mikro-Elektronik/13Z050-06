<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - Z50 GPIO MDIS5 Driver - Main Page</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;">
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">Z50 GPIO MDIS5 Driver &nbsp; </h1>
	<h3>Main Page</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindexHL" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>Z50 GPIO MDIS5 Driver Documentation</h1>
<p>
This is the documentation of the MDIS5 low-level driver for the GPIO controller implemented in the FPGA on F401. It also works on the D302 "Model Infineon" (D302i).<p>
The GPIO controller supports the following features:<p>
<ul>
<li>32 bit general purpose I/O (128 bit on D302i) state of output port pins</li><li>readable on D302i ability to generate interrupts on rising, falling or</li><li>both edges on port hardware debouncing time adjustable for every port</li></ul>
<p>
This driver supports the MEN Binary Input Output Controller (BIOC). It uses call locking.<p>
<br>
 <h2><a name="Variants"></a>
Variants</h2>
(no variants)<p>
<br>
 <h2><a name="FuncDesc"></a>
Functional Description</h2>
<br>
 <h3><a name="General"></a>
General</h3>
The most functions return/take an 32 bit value. If not described differently every bit in the set/read values correspond to a single IO port pin. Bit 0 (LSB) to port 0, bit 31 (MSB) to port 31.<p>
<br>
 <h3><a name="channels"></a>
Logical channels</h3>
If used on the D302i board the driver supports four channels from which each one handles up to 32 inputs/outputs. This behaviour depends on the state of descriptor entry Z50_D302I.<p>
<br>
 <h3><a name="readwrite"></a>
Reading and writing</h3>
The driver supports multiple channels (selectable using MDIS SetStat M_MK_CH_CURRENT) each one handling a goup of up to 32 input/output ports. The ports of one group can only be influenced together.<p>
The <a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a10">M_read()</a> function call reads the current state of all ports of the current channel at once. <a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a11">M_write()</a> forces all output ports to the given level or affects the power switches associated with the ports, dependant on the hardware circuity connected to the port.<p>
<ul>
<li>Bit=0: low level on port pin (or switch closed)</li><li>Bit=1: high level on port pin (or switch open)</li></ul>
<p>
Additionally ports can be set/ cleared using SetStat Z50_SET_PORTS and Z50_CLEAR_PORTS. These functions affect only the ports whose corresponding bits are set in the given value.<p>
Data direction of the ports cannot be programmed.<p>
<br>
 <h3><a name="edgedetection"></a>
Edge detection</h3>
Using GetStat Z50_EDGE_RISE the application can determine if a rising edge has happened on each of the inputs on one channel. The function returns a 32 bit value in which each bit represents one input.<p>
<ul>
<li>Bit=1: rising edge on this port since last request</li><li>Bit=0: no rising edge</li></ul>
<p>
This call clears all 32 bits of the current channel.<p>
GetStat Z50_EDGE_FALL works the same way but for falling edges.<p>
<br>
 <h3><a name="interrupts"></a>
Interrupt handling and signals</h3>
SetStats Z50_IRQ_EDGE_RISE and Z50_IRQ_EDGE_FALL enable interrupt generation on rising and/or falling edge on any input of the current channel. The functions take a 32 bit value in which each bit corresponds to an input.<p>
<ul>
<li>Bit=1: generate interrupt on rising/falling edge of this input</li><li>Bit=0: no interrupt.</li></ul>
<p>
If an interrupt happens the driver will send the signal which was assigned using SetStat Z50_IRQ_SIGNAL to the application.<p>
The current status can be read back using GetStats Z50_IRQ_EDGE_RISE and Z50_IRQ_EDGE_FALL.<p>
<br>
 <h3><a name="debounce"></a>
Debouncing</h3>
Debouncing is enabled using block SetStat Z50_BLK_DEBOUNCE. This function takes the pointer to a <a class="el" href="structZ50__DEBOUNCE__PB.html">Z50_DEBOUNCE_PB</a> structure containing fields <em>input</em> and <em>time</em>.<p>
<ul>
<li><b>BIOC</b>: Input designates the number of the input of the current channel whose debouncing value is to be set. Valid range is 0..31.</li><li><b>D302</b>: Input is ignored. Time is valid for all inputs of the current channel.</li></ul>
<p>
<em>Time</em> is the debouncing time measured in steps of 50µsec. It is an unsigned 16bit integer, valid range is 0..0xffff. Zero turns the debouncing circuit off, 0xffff corresponds to a time of 3.267 sec (on D302).<p>
The current status can be read back using GetStat Z50_BLK_DEBOUNCE. Like its counterpart it takes a pointer to a <a class="el" href="structZ50__DEBOUNCE__PB.html">Z50_DEBOUNCE_PB</a> structure. <em>Input</em> has to be given by user, <em>time</em> is filled by the driver.<p>
When the debouncing time is updated, the new value is used after the current cycle is finished, i.e. the input has to be low for more than the old debouncing time.<p>
<br>
 <h3><a name="default"></a>
Default values</h3>
<a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a4">M_open()</a> and <a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a9">M_close()</a> set all ports to default values:<p>
<ul>
<li>All outputs are in state "off"</li><li>Interrupts disabled</li><li>Debouncing disabled</li></ul>
<p>
<br>
 <h2><a name="api_functions"></a>
Supported API Functions</h2>
<table border="0" cellspacing="3" cellpadding="3">
<tr>
<td><b>API function</b> </td><td><b>Functionality</b> </td><td><b>Corresponding low level function</b><p>
</td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a4">M_open()</a></td><td>Open device</td><td><a class="el" href="z50__drv_8c.html#a17">Z50_Init()</a><p>
</td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a9">M_close()</a> </td><td>Close device  </td><td><a class="el" href="z50__drv_8c.html#a18">Z50_Exit()</a>) </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a10">M_read()</a> </td><td>Read from device  </td><td><a class="el" href="z50__drv_8c.html#a19">Z50_Read()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a11">M_write()</a> </td><td>Write to device  </td><td><a class="el" href="z50__drv_8c.html#a20">Z50_Write()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a13">M_setstat()</a> </td><td>Set device parameter  </td><td><a class="el" href="z50__drv_8c.html#a21">Z50_SetStat()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a12">M_getstat()</a> </td><td>Get device parameter  </td><td><a class="el" href="z50__drv_8c.html#a22">Z50_GetStat()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a14">M_getblock()</a> </td><td>Block read from device  </td><td><a class="el" href="z50__drv_8c.html#a23">Z50_BlockRead()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/mdis__api_8c.html#a15">M_setblock()</a> </td><td>Block write from device  </td><td><a class="el" href="z50__drv_8c.html#a24">Z50_BlockWrite()</a> </td></tr>
<tr>
<td><a class="elRef" doxygen="mdis_api.tag:../../../../../LIBSRC/MDIS_API/DOC/html/" href="../../../../../LIBSRC/MDIS_API/DOC/html/m__errstr_8c.html#a1">M_errstringTs()</a> </td><td>Generate error message  </td><td>- </td></tr>
</table>
<p>
<br>
 <h2><a name="descriptor_entries"></a>
Descriptor Entries</h2>
The low-level driver initialization routine decodes the following entries ("keys") in addition to the general descriptor keys:<p>
<table border="0" cellspacing="3" cellpadding="3">
<tr>
<td><b>Descriptor entry</b> </td><td><b>Description</b> </td><td><b>Values</b> <p>
</td></tr>
<tr>
<td>Z50_D302I </td><td>Support for D302 Model Infineon enabled if 1 </td><td>0..1, default: 0 <p>
</td></tr>
</table>
<p>
<br>
 <h2><a name="codes"></a>
Z50 specific Getstat/Setstat codes</h2>
see <a class="el" href="z50__drv_8h.html#getstat_setstat_codes">section about Getstat/Setstat codes</a><p>
<br>
 <h2><a name="Documents"></a>
Overview of all Documents</h2>
<h3><a name="z50_simp"></a>
Simple example for using the driver</h3>
<a class="el" href="z50__simp_8c.html">z50_simp.c</a> (see example section)<h3><a name="z50_min"></a>
Minimum descriptor</h3>
z50_min.dsc demonstrates the minimum set of options necessary for using the drver.<h3><a name="z50_max"></a>
Minimum descriptor</h3>
z50_max.dsc shows all possible configuration options for this driver. 
	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for Z50 GPIO MDIS5 Driver using <a href="http://www.doxygen.org">doxygen</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

